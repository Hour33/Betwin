<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Register | Betwin</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#0b3d2e;
  color:#fff;
}
.container{
  padding:20px;
}

/* ===== HEADER ===== */
.header{
  background:#083025;
  padding:14px;
  display:flex;
  align-items:center;
  justify-content:space-between;
}
.logo{
  font-weight:bold;
  font-size:18px;
  color:#f6d34b;
}
.header-actions{
  display:flex;
  gap:10px;
}
.btn{
  padding:6px 14px;
  border-radius:20px;
  font-size:13px;
  cursor:pointer;
}
.btn.register{
  background:linear-gradient(90deg,#f6d34b,#f2b705);
  color:#000;
}
.btn.login{
  border:1px solid #2c6e4f;
}

/* ===== FORM ===== */
h2{
  text-align:center;
  margin:10px 0 30px;
}
input{
  width:100%;
  padding:16px;
  border:none;
  border-radius:30px;
  margin-bottom:15px;
  background:#1f4f3a;
  color:#fff;
  font-size:14px;
}
.phone{
  display:flex;
  gap:10px;
}
.phone select{
  background:#1f4f3a;
  border:none;
  border-radius:30px;
  padding:16px;
  color:#fff;
}
.checkbox{
  display:flex;
  align-items:center;
  gap:10px;
  margin:15px 0;
}
button.submit{
  width:100%;
  padding:16px;
  border:none;
  border-radius:30px;
  background:#2c6e4f;
  color:#fff;
  font-size:16px;
  cursor:pointer;
}
#msg{
  margin-top:10px;
  font-size:14px;
}

/* ===== BOTTOM NAV ===== */
.bottom{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  background:#083025;
  padding:10px 0;
  display:flex;
  justify-content:space-around;
  align-items:center;
}
.nav-item{
  text-align:center;
  font-size:12px;
  color:#cfcfcf;
}
.nav-item.active{
  color:#f6d34b;
}
.center-btn{
  background:#f6d34b;
  width:54px;
  height:54px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  color:#000;
  font-weight:bold;
  margin-top:-30px;
  cursor:pointer;
}
</style>
</head>

<body>

<!-- ===== HEADER ===== -->
<div class="header">
  <div class="logo">BETWIN</div>
  <div class="header-actions">
    <div class="btn register">Register</div>
    <div class="btn login" id="topLoginBtn">Login</div>
  </div>
</div>

<!-- ===== PAGE TITLE ===== -->
<h2>Welcome to<br><strong>BETWIN</strong></h2>

<!-- ===== FORM ===== -->
<div class="container">
  <input id="username" placeholder="Username">
  <div class="phone">
    <select id="countryCode">
      <option>+234</option>
    </select>
    <input id="phone" placeholder="Mobile">
  </div>
  <input type="password" id="password" placeholder="Password">
  <input type="password" id="confirmPassword" placeholder="Confirm Password">
  <div class="checkbox">
    <input type="checkbox" id="ageCheck">
    <span>Already over 18 years old</span>
  </div>
  <button class="submit" id="registerBtn">Register</button>
  <div id="msg"></div>
</div>

<!-- ===== BOTTOM NAV ===== -->
<div class="bottom">
  <div class="nav-item">Menu</div>
  <div class="nav-item">Home</div>
  <div class="center-btn">ðŸ‘¤</div>
  <div class="nav-item">Promo</div>
  <div class="nav-item">Member</div>
</div>

<script>
const SHEETY_URL = "https://api.sheety.co/9b805411b5ecdb493c774c33fb4e5b61/code3/code3";
const blockedPasswords = ["123456","moyin123","moyin1234","moyin12","difficult","difficulty","difficultydifficult"];

const pwInput = document.getElementById("password");
const pwWarning = document.getElementById("pwWarning");
const registerBtn = document.getElementById("registerBtn");
const msg = document.getElementById("msg");
const topLoginBtn = document.getElementById("topLoginBtn");

topLoginBtn.addEventListener("click", ()=> location.href="login.html");

// REGISTER LOGIC
registerBtn.addEventListener("click", async () => {
  const username = document.getElementById("username").value.trim();
  const phone = document.getElementById("phone").value.trim();
  const country = document.getElementById("countryCode").value.trim();
  const password = document.getElementById("password").value.trim();
  const confirmPassword = document.getElementById("confirmPassword").value.trim();
  const ageChecked = document.getElementById("ageCheck").checked;

  msg.textContent = "";
  if (!username || !phone || !password || !confirmPassword) {
    msg.style.color = "red";
    msg.textContent = "Please fill all fields";
    return;
  }
  if (!ageChecked) {
    msg.style.color = "red";
    msg.textContent = "You must confirm you are over 18";
    return;
  }
  if (blockedPasswords.includes(password.toLowerCase())) {
    msg.style.color = "red";
    msg.textContent = "Can't use that password";
    return;
  }
  if (password !== confirmPassword) {
    msg.style.color = "red";
    msg.textContent = "Passwords do not match";
    return;
  }

  registerBtn.disabled = true;
  msg.style.color = "#4caf50";
  msg.textContent = "Registering...";

  try {
    // Check if phone exists
    const checkRes = await fetch(`${SHEETY_URL}?filter[phone]=${encodeURIComponent(phone)}`);
    const checkData = await checkRes.json();
    if (checkData.code3 && checkData.code3.length > 0) {
      msg.style.color = "red";
      msg.textContent = "Account already exists";
      registerBtn.disabled = false;
      return;
    }

    // Create account
    const createRes = await fetch(SHEETY_URL, {
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body: JSON.stringify({
        code3:{
          username: username,
          phone: country+phone,
          password: password,
          balance: 200
        }
      })
    });
    if(!createRes.ok){
      msg.style.color="red";
      msg.textContent="Registration failed";
      registerBtn.disabled=false;
      return;
    }

    msg.style.color="#4caf50";
    msg.textContent="Registered successfully! Redirecting to login...";
    setTimeout(()=> location.href="login.html", 1000);

  } catch(err){
    msg.style.color="red";
    msg.textContent="Network error: "+err.message;
    registerBtn.disabled=false;
  }
});
</script>

</body>
  </html>
